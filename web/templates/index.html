{% extends "base.html" %}
{% block title %}Transactions{% endblock %}

{% block content %}

<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-label">Total Income</div>
        <div class="stat-value income">{{ summary.total_income }}</div>
        <div class="stat-sub">{{ current_month }}</div>
    </div>
    <div class="stat-card">
        <div class="stat-label">Total Expense</div>
        <div class="stat-value expense">{{ summary.total_expense }}</div>
        <div class="stat-sub">{{ current_month }}</div>
    </div>
    <div class="stat-card">
        <div class="stat-label">Balance</div>
        <div class="stat-value balance">{{ summary.balance }}</div>
        <div class="stat-sub">{{ current_month }}</div>
    </div>
</div>

<div class="card">
    <h2>Add Transaction</h2>
    <form action="/add-transaction" method="POST">
        <div class="form-row">
            <div class="form-group">
                <label>Amount</label>
                <input type="number" name="amount" step="0.01" placeholder="0.00" required>
            </div>
            <div class="form-group">
                <label>Description</label>
                <input type="text" name="description" placeholder="e.g. Grocery shopping" required>
            </div>
            <div class="form-group">
                <label>Category</label>
                <select name="category_id" required>
                    {% for c in categories %}
                    <option value="{{ c.id }}">{{ c.name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="form-group">
                <label>Type</label>
                <select name="type">
                    <option value="income">Income</option>
                    <option value="expense">Expense</option>
                </select>
            </div>
            <div class="form-group">
                <label>Date</label>
                <input type="date" name="date">
            </div>
            <div class="form-group" style="justify-content: flex-end;">
                <button type="submit" class="btn btn-primary">+ Add</button>
            </div>
        </div>
    </form>
</div>

<div class="card">
    <h2>Transaction List</h2>
    {% if transactions %}
    <table>
        <thead>
            <tr>
                <th>Date</th>
                <th>Type</th>
                <th>Category</th>
                <th>Description</th>
                <th>Amount</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            {% for t in transactions %}
            <tr>
                <td class="text-muted">{{ t.date }}</td>
                <td>
                    <span class="badge {{ 'badge-income' if t.type == 'income' else 'badge-expense' }}">
                        {{ t.type }}
                    </span>
                </td>
                <td>{{ t.category or '-' }}</td>
                <td>{{ t.description or '-' }}</td>
                <td class="{{ 'amount-income' if t.type == 'income' else 'amount-expense' }}">
                    {{ t.amount }}
                </td>
                <td>
                    <a href="/delete-transaction/{{ t.id }}" class="btn btn-danger" onclick="return confirm('Are you sure?')">Delete</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p class="empty-message">No transactions yet.</p>
    {% endif %}
</div>
{% endblock %}